<html>
<head>
</head>
<body>
<div>
    <a>
        Token
    </a>
    <input type="text" name="token" id="token"/>
</div>

<div>
    <a>
        Commit
    </a>
    <input type="text" name="commit" id="commit"/>
</div>

<div>
    <a>
        Type
    </a>
    <input type="text" name="type" id="type"/>
</div>

<div>
    <a>
        Branch
    </a>
    <input type="text" name="branch" id="branch"/>
</div>

<div>
    <a>
        File
    </a>
    <input type="file" id="file" name=file>
    </input>
</div>

<button onclick="uploadArtifacts()">
    Upload
</button>
</body>
</html>
<script>
    function readFile(file) {
        return new Promise((resolve, reject) => {
            let reader = new FileReader();
            reader.addEventListener("loadend", (e) => resolve(e.target.result));
            reader.addEventListener("error", reject);
            reader.readAsArrayBuffer(file);
        });
    }

    function uploadArtifacts() {
        var token = document.getElementById('token').value;
        var commit = document.getElementById('commit').value;
        var type = document.getElementById('type').value;
        var branch = document.getElementById('branch').value;
        var file = document.getElementById('file').value;
        var url = new URL('http://' + window.location.host + "/upload")
        var byteArray = new Uint8Array(readFile(file));
        url.searchParams.append("token", token);
        url.searchParams.append("commit", commit);
        url.searchParams.append("type", type);
        url.searchParams.append("branch", branch);
        fetch(url, {
            method: "POST",
            body: byteArray,
            // headers: {
            //     "Content-type": "application/json; charset=utf-8",
            // }
        })
            .then((output) => console.log(output));
    }
</script>